<section
  class="w-full h-screen flex bg-gray-50 dark:bg-neutral-950 transition-colors duration-300 overflow-hidden"
>
  <!-- ===== LEFT SIDEBAR (DESKTOP) ===== -->
  <aside
    class="hidden lg:flex flex-col border-r border-gray-200 dark:border-neutral-800 bg-gray-50 dark:bg-neutral-950 p-4 transition-all duration-300 ease-in-out"
    [class.w-64]="!sidebarCollapsed()"
    [class.w-20]="sidebarCollapsed()"
  >
    <!-- Top -->
    <div
      class="flex items-center justify-between"
      [class.flex-col]="sidebarCollapsed()"
    >
      <div
        class="flex items-center gap-2 overflow-hidden justify-center"
        [class.flex-col]="sidebarCollapsed()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-8 h-8 text-indigo-600 dark:text-amber-400 flex-shrink-0"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path d="M12 2L2 7l10 5 10-5-10-5z" />
          <path d="M2 17l10 5 10-5" />
        </svg>

        @if (!sidebarCollapsed()) {
        <h1
          class="text-xl font-semibold text-gray-900 dark:text-neutral-100 truncate"
        >
          Scrappy
        </h1>
        }
      </div>

      <!-- Collapse Button -->
      <button
        type="button"
        class="mt-2 flex items-center justify-center w-9 h-9 rounded-md border border-gray-300/60 dark:border-neutral-700/60 bg-white/80 dark:bg-neutral-900/80 hover:bg-gray-100/80 dark:hover:bg-neutral-800/80 transition-all duration-300"
        (click)="toggleSidebar()"
        aria-label="Collapse sidebar"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-4 h-4 text-gray-700 dark:text-neutral-200 transition-transform duration-300"
          [class.rotate-180]="sidebarCollapsed()"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path d="M15 19l-7-7 7-7" />
        </svg>
      </button>
    </div>

    <!-- Nav Links -->
    <nav
      class="flex flex-col space-y-2 text-sm font-medium mt-6"
      [ngClass]="{
        'items-center': sidebarCollapsed(),
        'items-stretch': !sidebarCollapsed()
      }"
    >
      <a
        routerLink="/dashboard"
        class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-600 dark:text-neutral-400 hover:bg-indigo-50 dark:hover:bg-neutral-800 hover:text-indigo-600 dark:hover:text-amber-400 transition"
        [ngClass]="{ 'justify-center': sidebarCollapsed() }"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path d="M3 13h8V3H3zM13 21h8v-8h-8zM13 3h8v8h-8zM3 13h8v8H3z" />
        </svg>
        @if (!sidebarCollapsed()) { <span>Dashboard</span> }
      </a>

      <a
        routerLink="/marketplace-page"
        class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-600 dark:text-neutral-400 hover:bg-indigo-50 dark:hover:bg-neutral-800 hover:text-indigo-600 dark:hover:text-amber-400 transition"
        [ngClass]="{ 'justify-center': sidebarCollapsed() }"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path d="M3 4h18v16l-9-4-9 4z" />
        </svg>
        @if (!sidebarCollapsed()) { <span>Marketplace</span> }
      </a>

      <a
        routerLink="/chat-page"
        class="flex items-center gap-3 px-3 py-2 rounded-lg text-indigo-600 dark:text-amber-400 bg-indigo-50 dark:bg-neutral-800 transition"
        [ngClass]="{ 'justify-center': sidebarCollapsed() }"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" />
        </svg>
        @if (!sidebarCollapsed()) { <span>Chat</span> }
      </a>

      <a
        routerLink="/analytics"
        class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-600 dark:text-neutral-400 hover:bg-indigo-50 dark:hover:bg-neutral-800 hover:text-indigo-600 dark:hover:text-amber-400 transition"
        [ngClass]="{ 'justify-center': sidebarCollapsed() }"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path d="M3 17h18M9 21V8m6 13v-6m6 6V4M3 21V11" />
        </svg>
        @if (!sidebarCollapsed()) { <span>Analytics</span> }
      </a>

      <a
        routerLink="/settings"
        class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-600 dark:text-neutral-400 hover:bg-indigo-50 dark:hover:bg-neutral-800 hover:text-indigo-600 dark:hover:text-amber-400 transition"
        [ngClass]="{ 'justify-center': sidebarCollapsed() }"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path d="M12 8a4 4 0 100 8 4 4 0 000-8z" />
          <path d="M2 12a10 10 0 0119.54-3.5 10 10 0 010 7A10 10 0 012 12z" />
        </svg>
        @if (!sidebarCollapsed()) { <span>Settings</span> }
      </a>

      <!-- === Dark Mode Toggle === -->
      <button
        type="button"
        (click)="toggleTheme()"
        class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-600 dark:text-neutral-400 hover:bg-indigo-50 dark:hover:bg-neutral-800 hover:text-indigo-600 dark:hover:text-amber-400 transition mt-4"
        [ngClass]="{ 'justify-center': sidebarCollapsed() }"
      >
        @if (!isDarkMode) {
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path
            d="M12 3v1m0 16v1m8.66-9h1M3.34 12h1m12.02 7.66l.7.7M5.34 5.34l.7.7m0 12.02l-.7.7m12.02-12.02l-.7.7M12 5a7 7 0 100 14 7 7 0 000-14z"
          />
        </svg>
        } @else {
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
        </svg>
        } @if (!sidebarCollapsed()) {
        <span>{{ isDarkMode ? "Light Mode" : "Dark Mode" }}</span>
        }
      </button>
    </nav>

    <!-- Chat List (desktop) -->
    <div
      class="border-t border-gray-200 dark:border-neutral-800 mt-6 pt-4 overflow-y-auto"
      [ngClass]="{ 'flex flex-col items-center': sidebarCollapsed() }"
    >
      @if (!sidebarCollapsed()) {
      <h2
        class="text-sm font-semibold text-gray-700 dark:text-neutral-300 mb-2"
      >
        Chats
      </h2>
      }

      <div
        class="space-y-2 overflow-y-auto max-h-[40vh]"
        [ngClass]="{ 'space-y-4': sidebarCollapsed() }"
      >
        <div
          class="flex items-center gap-3 p-2 rounded-xl cursor-pointer hover:bg-indigo-50 dark:hover:bg-neutral-800 transition"
          [ngClass]="{ 'justify-center': sidebarCollapsed() }"
        >
          <img
            src="https://i.pravatar.cc/100?img=3"
            class="w-8 h-8 rounded-full ring-2 ring-indigo-100 dark:ring-amber-300/40"
          />
          @if (!sidebarCollapsed()) {
          <div>
            <p class="font-medium text-gray-900 dark:text-neutral-100">
              Lindsey Curtis
            </p>
            <p class="text-xs text-gray-500 dark:text-neutral-400">
              Project Manager
            </p>
          </div>
          }
        </div>
      </div>
    </div>
  </aside>

  <!-- ===== MAIN CHAT AREA ===== -->
  <div class="flex-1 flex relative">
    <!-- MOBILE COMBINED SIDEBAR -->
    @if (mobileSidebarOpen()) {
    <aside
      class="fixed inset-y-0 left-0 z-50 w-3/4 max-w-sm bg-gray-50 dark:bg-neutral-950 border-r border-gray-200 dark:border-neutral-800 p-6 overflow-y-auto space-y-6 transition-transform duration-300 ease-in-out shadow-xl backdrop-blur-md"
    >
      <!-- Top -->
      <div class="flex items-center justify-between">
        <h1 class="text-lg font-semibold text-gray-900 dark:text-neutral-100">
          Menu
        </h1>
        <button
          type="button"
          class="flex items-center justify-center w-9 h-9 rounded-md border border-gray-300/60 dark:border-neutral-700/60 bg-white/80 dark:bg-neutral-900/80 hover:bg-gray-100/80 dark:hover:bg-neutral-800/80"
          (click)="toggleMobile()"
          aria-label="Close menu"
        >
          âœ•
        </button>
      </div>

      <!-- Combined Nav -->
      <nav class="flex flex-col space-y-2 text-sm font-medium">
        <a
          routerLink="/dashboard"
          class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-600 dark:text-neutral-400 hover:bg-indigo-50 dark:hover:bg-neutral-800 hover:text-indigo-600 dark:hover:text-amber-400 transition"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <path d="M3 13h8V3H3zM13 21h8v-8h-8zM13 3h8v8h-8zM3 13h8v8H3z" />
          </svg>
          <span>Dashboard</span>
        </a>

        <a
          routerLink="/marketplace"
          class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-600 dark:text-neutral-400 hover:bg-indigo-50 dark:hover:bg-neutral-800 hover:text-indigo-600 dark:hover:text-amber-400 transition"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <path d="M3 4h18v16l-9-4-9 4z" />
          </svg>
          <span>Marketplace</span>
        </a>
      </nav>

      <hr class="border-gray-200 dark:border-neutral-800 my-4" />

      <!-- Chat List -->
      <div>
        <h2
          class="text-sm font-semibold text-gray-700 dark:text-neutral-300 mb-2"
        >
          Chats
        </h2>
        <div class="space-y-2 overflow-y-auto">
          <div
            class="flex items-center gap-3 p-2 rounded-xl cursor-pointer hover:bg-indigo-50 dark:hover:bg-neutral-800 transition"
          >
            <img
              src="https://i.pravatar.cc/100?img=3"
              class="w-8 h-8 rounded-full ring-2 ring-indigo-100 dark:ring-amber-300/40"
            />
            <div>
              <p class="font-medium text-gray-900 dark:text-neutral-100">
                Lindsey Curtis
              </p>
              <p class="text-xs text-gray-500 dark:text-neutral-400">
                Project Manager
              </p>
            </div>
          </div>
        </div>
      </div>
    </aside>

    <div
      class="fixed inset-0 bg-black/40 dark:bg-black/70 z-40"
      (click)="toggleMobile()"
    ></div>
    }

    <!-- CHAT BODY -->
    <div class="flex-1 flex flex-col">
      <!-- Header -->
      <header
        class="flex items-center justify-between px-6 py-4 border-t border-b border-gray-200 dark:border-neutral-800 bg-white/80 dark:bg-neutral-900/80 backdrop-blur-md"
      >
        <div class="flex items-center gap-3">
          <!-- Mobile Toggle -->
          <button
            type="button"
            class="flex lg:hidden items-center justify-center w-10 h-10 rounded-lg border border-gray-300/60 dark:border-neutral-700/60 bg-white/80 dark:bg-neutral-900/80 backdrop-blur-sm hover:bg-gray-100/80 dark:hover:bg-neutral-800/80 transition-all duration-300"
            (click)="toggleMobile()"
            aria-label="Open menu"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5 text-gray-800 dark:text-neutral-200"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              viewBox="0 0 24 24"
            >
              <path d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>

          <img
            src="https://i.pravatar.cc/100?img=3"
            class="w-10 h-10 rounded-full ring-2 ring-indigo-100 dark:ring-amber-300/40"
          />
          <div>
            <p class="font-semibold text-gray-900 dark:text-neutral-100">
              Lindsey Curtis
            </p>
            <p class="text-xs text-gray-500 dark:text-neutral-400">online</p>
          </div>
        </div>
      </header>

      <!-- Messages -->
      <main
        class="flex-1 overflow-y-auto p-6 space-y-6 bg-gray-50 dark:bg-neutral-950"
      >
        <div class="flex items-start gap-3">
          <img
            src="https://i.pravatar.cc/100?img=3"
            class="w-8 h-8 rounded-full"
          />
          <div>
            <div
              class="inline-block bg-gray-200 dark:bg-neutral-800 text-gray-900 dark:text-neutral-100 rounded-2xl px-4 py-2 text-sm"
            >
              I want to make an appointment tomorrow from 2:00 to 5:00 PM.
            </div>
            <p class="text-xs text-gray-400 mt-1">2 hours ago</p>
          </div>
        </div>

        <div class="flex justify-end">
          <div
            class="inline-block bg-indigo-600 dark:bg-amber-400 text-white dark:text-neutral-900 rounded-2xl px-4 py-2 text-sm"
          >
            Sure, that works for me!
          </div>
        </div>
      </main>

      <!-- Input -->
      <footer
        class="p-4 border-t border-gray-200 dark:border-neutral-800 flex items-center gap-3 bg-white dark:bg-neutral-900"
      >
        <input
          type="text"
          placeholder="Type a message..."
          class="flex-1 rounded-full p-3 bg-gray-100 dark:bg-neutral-800 text-sm text-gray-800 dark:text-neutral-100 focus:outline-none focus:ring-2 focus:ring-indigo-500"
        />
        <button
          class="p-3 rounded-full bg-indigo-600 hover:bg-indigo-700 dark:bg-amber-400 dark:hover:bg-amber-500 transition-all"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="w-5 h-5 text-white dark:text-neutral-900"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <path d="M22 2L11 13"></path>
            <path d="M22 2L15 22L11 13L2 9L22 2Z"></path>
          </svg>
        </button>
      </footer>
    </div>
  </div>
</section>
